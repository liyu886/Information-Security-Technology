## 信息安全技术作业

李钰  19335112

![image-20220101131815703](C:\Users\16435\AppData\Roaming\Typora\typora-user-images\image-20220101131815703.png)

解：

1. 显然上述协议无法阻止 cheating。因为为了验证 Alice 没有修改 *x* 即验证 *h*(*x*) , Bob 必须知道 *h* 。而石头-剪刀-布游戏中总共只有三种策略, *Bob* 可以尝试枚举每一种策略 *x* 并得到 *h*(*x*)，进而与 Alice 发来的结果进行匹配, 从而得出 Alice 的策略，再来决定自己的策略, 所以必定能赢。

2. Alice 在 *h* 的输入值中添加随机性来防止暴力枚举, 例如 Alice 可以在第一步中发送 *h*(*x*+*r*)而非 *h*(*x*) ，其中 *r* 为随机生成的整数，第三步中 Alice 再将 *x* 与 *r* 一起发送给 Bob，这样就可以使得 Bob 无法枚举破解。

------

![image-20220101132024178](C:\Users\16435\AppData\Roaming\Typora\typora-user-images\image-20220101132024178.png)

解：

1. 我们构造以下攻击：假设攻击者为R，并且它可以截获A，B间通信的信息，则有如下攻击形式
   $$
   A→R:A,N_A,B\\
   R→B:R,N_A,B\\
   B→R:B,N_B,\{N_A\}_K,R\\
   R→A:B,N_B,\{N_A\}_K,A\\
   A → R : A, \{N_B\}k, B\\
   R → B : R, \{N_B\}k, B
   $$
   至此，R 获得了 B 的认证，与 B 建立了通信。

2. 解决以上攻击的方法可以为：

   *A* 与 *B* 将公开信息进行加密用于验证，即：

$$
A → B : A, \{N_A\}k, B\\
B → A : B, NB, \{N_A, B\}k, A\\
A → B : A, \{N_B, A\}k, B
$$

​		之前的攻击是 *R* 将自己的 *ID* 替换了 *A* 的 *ID* 使得攻击成功，那么，我们就是用含有*nounce* 和 *ID* 的密文来确定 *ID* 的正确性，这样 *R* 就无法成功攻击了。

------

![image-20220101132754987](C:\Users\16435\AppData\Roaming\Typora\typora-user-images\image-20220101132754987.png)

解：因为 PIN 均由数字组成且显示器是安全的，所以可以在显示器上每隔若干，显示一个 0 - 9 的数字，当这个数字是被设置的密码时则按下空格继续输入下一个数字。当密码输入完成时按回车结束即可，这样就可以保证用户输入 PIN 时是安全的。

------

![image-20220101132907964](C:\Users\16435\AppData\Roaming\Typora\typora-user-images\image-20220101132907964.png)

解:

1.  由 *Shamir* 密钥共享原理，我们随机选择 10 个数作为系数, 即可构造出如下的多项式：
   $$
   f(x) = a_0 + a_1x + … +a_9x_9
   $$
   对于 (10*,* 30) 的临界点方案，我们随机生成 30 个整数输入到 *f*() 中得到 30 个点。根据题意, 将其中 10 个点分配给将军, 给两个上校每个人各分配 5 个点, 5 人各分配 2 个点，则可知只要有大于等于十个点时就可以确定 *f* ，显然题目要求的情况均可满足。

2. 由于任意两人可以确定加密信息, 因此，*Shamir Screct* 的多项式必定为一次多项式，即可写为: 
   $$
   y = (a_0 + a_1x) mod 11
   $$
   根据数据分析可以发现 $(1, 4),(3, 7),(7, 2) $都满足 $y = 8x + 7 (mod 11) $，故 *C* 应为间谍，

   并且秘密信息可以知道为 $a_0 = 8 (mod11)$​ 。 

   ------

   

![image-20220101133407575](C:\Users\16435\AppData\Roaming\Typora\typora-user-images\image-20220101133407575.png)

解：我们可以设计如下剩余步骤使得满足题目要求：

4. Victor 随机选取一个 *m* *∈ {*1*,* 2*,* 3*}* 和一个 *n* *∈ {*1*,* 2*,* 3*}* 发送给 Peggy;

5. 之后 Peggy 再发送 $r_m$ 和 $r_n$ 给 Victor;

6. Victor 验证等式 $x_m = r^2_m$和$ x_n = r^2_n$ 是否正确;

7. 将上述步骤重复 5 次，每次重新选择$r_1,r_2,r_3$，并使得$r_1,r_2,r_3= x (mod n)$.

接下来说明如上步骤是可行的：

​		显然当 Peggy 不知道正确答案时，他随机猜测一个正确的概率是$\frac{1}{3}$，而在重复 5 次的情况下均猜对的概率为 $\frac{1}{3}^5=\frac{1}{243}<0.01$,所以 Victor 至少有 99% 的几率相信 Peggy 没有撒谎。

